# vk_demo_bot

Демонстрационная версия бота ВК для сообществ, оказывающих платные услуги. 
Бот работает на следующем стэке: 
* код на Python;
* библиотека vk_api для запросов к API ВК;
* библиотека SqlAlchemy для запросов к базе данных (PostgreSQL).

Основная цель бота: автоматизация процесса приёма и обработки обращений в группах ВК, предлагающих ограниченный перечень типовых услуг, осуществляемых дистанционно (онлайн-консультирование, репетиторство, услуги рекламы, дизайна, подготовки документов, и т.п.).

## Возможности

Бот работает на основе заранее заданных команд. Распознавание текста и намерений пользователя с помощью машинного обучения отсутствуют, так что при вводе неверных команд бот будет выдавать ошибку. 

В данном боте реализованы: 
* ветвление диалога в зависимости от команды пользователя;
* сбор ответов на типовые вопросы по заказу в отдельной ветке;
* сохранение информации, полученной в ветке оформления заказа (текста, документов, фото) в базе данных;
* отправка администратору в одном сообщении собранных ответов и документов от пользователя после завершения оформления заказа;
* "выключение" бота после завершения оформления заказа, чтобы дать возможность администратору продолжить диалог с клиентом в свободной форме и "включение" по командам от пользователя или администратора.


## Тестирование возможностей

Возможности бота могут быть протестированы в следующей тестовой группе ВК: ########
Бот из данного репозитория подключен именно к этой группе. 
Сценарий бота написан таким образом, чтобы подробно описать его функционал без привязки к конкретной предметной области.  

## Структура проекта

* Main.py - файл запуска бота. Запускает "прослушивание" longpoll-сервера и начальную обработку получаемых событий. 
* vk_functions.py - файл, содержащий вспомогательные custom-функции для работы с требуемыми методами API ВК;
* handlers.py - содержит полный алгоритм обработки событий ВК;
* messages.py - содержит тексты, которыми бот отвечает и команды, на которые он реагирует;
* keyboard.py - файл для создания клавиатур, прикреплённых к сообщениям бота;
* db.py - параметры соединения с БД;
* db_models.py - схема БД (таблицы), используемая для работы чат-бота;
* db_functions.py - файл с функциями, ответственными за взаимодействие бота с БД (DML-команды). 

В каждом файле также имеется подробное описание работы каждой части кода. 
Стиль написания кода и комментариев исходит из субъективных предположений об удобстве восприятия и может не соответствовать классическим правилам PEP-8. 
Но все замечания линтера, кроме длинны строк, по возможности были учтены. 

## Запуск на локальной машине

Установка python
Виртуальное окружение
Установка библиотек
Создание базы данных
settings.py
Настройка линтера




## Перспективы проекта

Данный бот создавался для решения конкретной прикладной задачи, а также фиксации достигнутого уровня мастерства его разработчика =) 
Развитие из текущего состояния в рамках данного проекта далее не планируется. 
Минимальные улучшения возможны лишь для совместимости с актуальной версией API ВК. 

В отдалённой перспективе могут быть рассмотрены:
* возможность создания аналогичного бота на базе асинхронной библиотеки (например, VkWave) и технологии SVM для создания веток сценариев бота;
* расширение использования бота на несколько сообществ ВК (на данный момент его можно использовать лишь как одно веб-приложение для одной группы, для запуска на другой группе необходимо запускать клон такого же приложения с другими настройками); 
* оптимизация работы с БД (обработка незакрытых соединений и обрыва соединений);
* выполнение задач по расписанию (отмена незавершённых заказов, периодические рассылки для пользователей или администратора);
* логирование событий. 

Указанные задачи будут решаться уже в рамках отдельного нового проекта (и, соответственно, репозитория). 